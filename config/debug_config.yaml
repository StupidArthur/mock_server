# PLC Mock Server 调试专用组态配置文件
# 此配置文件专门用于调试模块（debug/debug_runner.py），与主系统配置独立

# 运行周期（秒），500ms
cycle_time: 0.5

# 物理模型实例配置
models:
  tank1:
    type: cylindrical_tank
    params:
      # 水箱参数调整说明：
      # 进一步减小水箱容量和增大入水流量，加快系统响应速度
      # 第一轮：radius=1.0→0.7, inlet_area=0.02→0.04（30分钟稳定）
      # 第二轮：radius=0.7→0.5（容量再减小约50%），inlet_area=0.04→0.06（入水流量再增50%），inlet_velocity=2.0→3.0（流速增加50%）
      height: 2.0          # 水箱高度（米）（保持）
      radius: 0.5            # 水箱半径（米）（调整：从0.7减小到0.5，容量再减小约50%）
      inlet_area: 0.06       # 入水管面积（平方米）（调整：从0.04增大到0.06，入水流量再增50%）
      inlet_velocity: 3.0    # 入水口水流速（米/秒）（调整：从2.0增大到3.0，流速增加50%）
      outlet_area: 0.001     # 出水口面积（平方米）（保持）
      initial_level: 0.0     # 初始水位（米）
      step: 0.5              # 步进时间（秒）

  valve1:
    type: valve
    params:
      min_opening: 0.0       # 最小开度（%）
      max_opening: 100.0     # 最大开度（%）
      step: 0.5              # 步进时间（秒）
      # 阀门响应时间调整：
      # 第一轮：从20.0秒减小到8.0秒（30分钟稳定）
      # 第二轮：进一步减小到5.0秒，加快阀门响应速度
      full_travel_time: 5.0  # 满行程时间（秒）（调整：从8.0减小到5.0，加快响应）

# 控制算法实例配置
algorithms:
  pid1:
    type: PID
    params:
      name: PID1
      # PID参数调整说明：
      # 第一轮：kp=40.0→10.0, ti=20.0→35.0, td=0.1→0.15（30分钟稳定）
      # 第二轮：进一步优化PID参数，加快响应速度
      # kp: 适当增大到12.0，加快响应（但不能太大，避免振荡）
      # ti: 适当减小到30.0，加快积分作用（但不能太小，避免振荡）
      # td: 保持0.15，抑制超调
      kp: 12.0                # 比例系数（调整：从10.0增大到12.0，加快响应）
      ti: 30.0               # 积分时间（秒）（调整：从35.0减小到30.0，加快积分作用）
      td: 0.15               # 微分时间（秒）（保持0.15，抑制超调）
      pv: 0.0                # 过程变量初始值
      sv: 1.0                # 设定值
      mv: 0.0                # 输出值初始值
      h: 100.0               # 输出上限
      l: 0.0                 # 输出下限
      sample_time: 0.5       # 采样周期（秒）

# 连接关系配置
connections:
  # PID输出 -> 阀门目标开度
  - from: pid1.mv
    to: valve1.target_opening
  
  # 阀门当前开度 -> 水箱阀门开度
  - from: valve1.current_opening
    to: tank1.valve_opening
  
  # 水箱液位 -> PID过程变量
  - from: tank1.level
    to: pid1.pv

