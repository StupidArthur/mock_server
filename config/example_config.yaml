# PLC Mock Server 示例组态配置文件

# 运行周期（秒），500ms
cycle_time: 0.5

# 注意：不再支持start_datetime和initial_acceleration_duration配置项
# 时间戳使用系统时间，如需时间加速功能，请使用独立的调试模块（debug/debug_runner.py）

# 物理模型实例配置
models:
  tank1:
    type: cylindrical_tank
    params:
      # 只保留与默认值不同的参数
      initial_level: 0.0     # 初始水位（米），默认值为0.0

  valve1:
    type: valve
    # 所有参数都是默认值，无需配置params

  tank2:
    type: cylindrical_tank
    params:
      initial_level: 0.0

  valve2:
    type: valve

  tank3:
    type: cylindrical_tank
    params:
      initial_level: 0.0

  valve3:
    type: valve

# 控制算法实例配置
algorithms:
  pid1:
    type: PID
    params:
      name: PID1            # 算法名称，默认值为"PID"，这里设置为"PID1"
      sv: 1.0               # 设定值，默认值为0.0，这里设置为1.0

  pid2:
    type: PID
    params:
      name: PID2
      sv: 1.0

  pid3:
    type: PID
    params:
      name: PID3
      sv: 1.0

# 连接关系配置
connections:
  # 第一组：pid1 -> valve1 -> tank1 -> pid1
  - from: pid1.mv
    to: valve1.target_opening
  - from: valve1.current_opening
    to: tank1.valve_opening
  - from: tank1.level
    to: pid1.pv
  
  # 第二组：pid2 -> valve2 -> tank2 -> pid2
  - from: pid2.mv
    to: valve2.target_opening
  - from: valve2.current_opening
    to: tank2.valve_opening
  - from: tank2.level
    to: pid2.pv
  
  # 第三组：pid3 -> valve3 -> tank3 -> pid3
  - from: pid3.mv
    to: valve3.target_opening
  - from: valve3.current_opening
    to: tank3.valve_opening
  - from: tank3.level
    to: pid3.pv

